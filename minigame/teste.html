<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Perseguição Funcional</title>
<style>
  body {
    margin: 0;
    height: 100vh;
    display: flex;
    justify-content: center;
    align-items: center;
    background: #111
  }
  .arena {
    position: relative;
    width: 500px;
    height: 300px;
    background: #222;
    border: 3px solid #555;
    border-radius: 12px;
    overflow: hidden
  }
  .bloco {
    position: absolute;
    width: 50px;
    height: 50px;
    background: #09461f;
    border-radius: 8px
  }
  .inimigo {
    position: absolute;
    width: 40px;
    height: 40px;
    background: crimson;
    border-radius: 50%
  }
</style>
</head>
<body>
  <div class="arena" id="arena"></div>
<script>
const arena = document.getElementById("arena")

const criarBloco = (pos) => {
  const b = document.createElement("div")
  b.className = "bloco"
  b.style.left = pos.x + "px"
  b.style.top  = pos.y + "px"
  arena.appendChild(b)
  return b
}
const criarInimigo = (pos) => {
  const b = document.createElement("div")
  b.className = "inimigo"
  b.style.left = pos.x + "px"
  b.style.top  = pos.y + "px"
  arena.appendChild(b)
  return b
}

const EstadoInicial = {
  jogador: {x: 100, y: 120},
  inimigo: {x: 400, y: 200}
}

const bloco   = criarBloco(EstadoInicial.jogador)
const inimigo = criarInimigo(EstadoInicial.inimigo)

const render = (estado) => {
  bloco.style.left   = estado.jogador.x + "px"
  bloco.style.top    = estado.jogador.y + "px"
  inimigo.style.left = estado.inimigo.x + "px"
  inimigo.style.top  = estado.inimigo.y + "px"
}

const mover = (estado, tecla) => {
  const passo = 15
  const maxX = arena.clientWidth - 50
  const maxY = arena.clientHeight - 50
  const novoJog = {
    x: tecla === 'ArrowRight' ? estado.jogador.x + passo : 
       tecla === 'ArrowLeft'  ? estado.jogador.x - passo : estado.jogador.x,
    y: tecla === 'ArrowUp'    ? estado.jogador.y - passo : 
       tecla === 'ArrowDown'  ? estado.jogador.y + passo : estado.jogador.y
  }
  return {
    ...estado,
    jogador: {
      x: Math.min(Math.max(novoJog.x, 0), maxX),
      y: Math.min(Math.max(novoJog.y, 0), maxY)
    }
  }
}

const perseguir = (estado) => {
  const passo = 0.8
  const dx = estado.jogador.x - estado.inimigo.x
  const dy = estado.jogador.y - estado.inimigo.y
  const dist = Math.sqrt(dx*dx + dy*dy) || 1
  return {
    ...estado,
    inimigo: {
      x: estado.inimigo.x + (dx/dist) * passo,
      y: estado.inimigo.y + (dy/dist) * passo
    }
  }
}

let estado = EstadoInicial

document.addEventListener("keydown", (e) => {
  const teclas = ["ArrowRight","ArrowLeft","ArrowUp","ArrowDown"]
  if(teclas.includes(e.key)){
    estado = mover(estado, e.key)
  }
})

const loop = () => {
  estado = perseguir(estado)
  render(estado)
  requestAnimationFrame(loop)
}

loop()
</script>
</body>
</html>
